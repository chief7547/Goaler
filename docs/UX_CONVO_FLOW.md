# 변주 선택 대화 흐름 스크립트 (MVP)

이 문서는 챗봇이 LLM 변주 제안을 사용자에게 어떻게 전달하고, 어떤 정보를 수집해야 하는지 단계별 대화 예시를 제공합니다. 화면 UI와 동일한 로직을 음성/텍스트 대화에도 반영합니다.

## 1. 변주 제안 단계
1. **챗봇 안내 문구**
   - "어제와 비슷한 목표지만, 오늘은 두 가지 방법을 준비했어요. 어떤 걸 해보고 싶으신가요?"
2. **변주 카드 요약**
   - 변주 A: 제목, 예상 시간, 난이도 배지, 변주 이유
   - 변주 B: 동일 형식
3. **선택 요청**
   - "A와 B 중에 마음에 드는 걸 골라 주세요. 고민된다면 자세히 물어보셔도 좋아요."

## 2. 선택 후 확인
1. **사용자 입력**
   - 예: "B로 할게"
2. **챗봇 확인**
   - "좋아요! 오늘은 B를 진행해 봅시다. 끝나고 나서 오늘 얻은 전리품만 한 줄로 공유해 주세요."
3. **상태 업데이트**
   - `choose_quest` 도구 호출 → `quest_id` 확정

## 3. 완료/피드백 수집
1. **챗봇 질문 (완료 시)**
   - "전리품 덱에 어떤 조각을 남기고 싶나요? [성과/깨달음/느낌] 중 하나를 골라주세요."
   - 사용자가 칩을 고르면: "좋아요! 한 줄로만 남겨 주시면 전리품에 추가할게요."
2. **에너지 상태 선택(선택 사항)**
   - "다음 턴을 위해 체력 체크해 볼까요? 보스전 준비됨 / 페이스 유지 / 물약 필요 중 골라 주세요."
3. **도구 호출**
   - `log_quest_outcome`에 outcome, energy_status, loot_type, mood_note(전리품 기록) 전달
4. **경고 레벨 안내**
   - Warning: "회복이 필요해 보이네요. 내일은 회복 변주를 함께 넣어둘게요."
   - Critical: "연속으로 힘들다고 느끼셨어요. 오늘은 보완 퀘스트를 기본으로 준비할게요."
   - Emergency: "포션 의식이 발동했어요! 이틀 동안 회복 루틴을 따라가면 전리품이 잘 보존될 거예요."

## 4. 실패/건너뛰기 시 흐름
- 챗봇: "오늘은 회복이 더 중요하겠네요. 물약을 챙긴 걸로 기록해 둘게요. 내일은 부담 덜한 방식을 준비할게요."
- outcome에 `SKIPPED` 또는 `DEFERRED` 저장, 필요 시 짧은 이유 선택(시간 부족/컨디션 문제/다른 일정 등)을 받아 휴식 전략을 제안하고 `energy_status`는 `NEEDS_POTION`으로 설정

## 5. 리마인더와 연동
- 리마인더 메시지에는 최근 선택한 변주와 피드백을 반영
- 예: "어제 ‘집에서 체중 운동 콤보’를 적당하다고 느끼셨죠. 오늘은 15분 집중 루틴으로 가볍게 이어가 볼까요?"

> 이 스크립트는 챗봇/텍스트 기반 인터페이스를 기준으로 하며, UI에서는 동일 내용을 카드·모달로 표현합니다.
